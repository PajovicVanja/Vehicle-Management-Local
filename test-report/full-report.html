<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:3,&quot;tests&quot;:21,&quot;passes&quot;:16,&quot;pending&quot;:0,&quot;failures&quot;:5,&quot;start&quot;:&quot;2025-11-25T09:02:07.416Z&quot;,&quot;end&quot;:&quot;2025-11-25T09:03:20.918Z&quot;,&quot;duration&quot;:73502,&quot;testsRegistered&quot;:21,&quot;passPercent&quot;:76.19047619047619,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;206e4f02-6832-4676-b2ea-b66b921e6d2a&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;title&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation&quot;,&quot;fullFile&quot;:&quot;C:\\aaFERI\\PREDMETI\\3. Semestar\\VUI\\App\\RIRSsolo\\automation\\admin_vehicle_tests.js&quot;,&quot;file&quot;:&quot;\\automation\\admin_vehicle_tests.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation \&quot;before all\&quot; hook in \&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:610,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let options = new chrome.Options();\noptions.addArguments(&#x27;--remote-allow-origins=*&#x27;);\noptions.addArguments(&#x27;--disable-search-engine-choice-screen&#x27;);\noptions.addArguments(&#x27;--start-maximized&#x27;);\ndriver = await new Builder().forBrowser(&#x27;chrome&#x27;).setChromeOptions(options).build();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67730196-6e96-4ea9-93c7-49c30bdaff2e&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation \&quot;after all\&quot; hook in \&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11293,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!driver) return;\nconsole.log(&#x27;\\n   [Cleanup] Starting \&quot;Search &amp; Destroy\&quot; Sequence...&#x27;);\ntry {\n    // 1. Force Reset to Dashboard to ensure we aren&#x27;t stuck on an Error page\n    await driver.get(APP_URL);\n    await driver.sleep(1000);\n    // 2. Safety Net: Re-login if session was lost\n    const loginInputs = await driver.findElements(By.css(&#x27;input[type=\&quot;email\&quot;]&#x27;));\n    if (loginInputs.length &gt; 0) {\n        console.log(\&quot;   [Cleanup] Session lost. Re-logging in...\&quot;);\n        await loginInputs[0].sendKeys(ADMIN_EMAIL);\n        await driver.findElement(By.css(&#x27;input[type=\&quot;password\&quot;]&#x27;)).sendKeys(ADMIN_PASS);\n        await driver.findElement(By.className(&#x27;login-button&#x27;)).click();\n        await driver.sleep(1000);\n    }\n    // 3. Navigate to List\n    const viewBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Vehicles&#x27;]\&quot;)), 5000);\n    await viewBtn.click();\n    \n    // 4. Wait for Table to Render\n    await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n    // 5. DELETE LOOP\n    for (const tc of testCases) {\n        const name = tc.data.name;\n        // Loop until no rows with this name exist\n        while (true) {\n            try {\n                // Find row with name\n                const xpath = `//tr[td[contains(text(), &#x27;${name}&#x27;)]]//button[text()=&#x27;Delete&#x27;]`;\n                const btns = await driver.findElements(By.xpath(xpath));\n                if (btns.length === 0) break; // Clean!\n                // Delete found instance\n                const btn = btns[0];\n                await driver.executeScript(\&quot;arguments[0].scrollIntoView(true);\&quot;, btn);\n                await btn.click();\n                console.log(`   [Cleanup] Deleted residual: ${name}`);\n                \n                // Wait for refresh\n                await driver.sleep(1500);\n            } catch (e) {\n                break; // Move to next name on error\n            }\n        }\n    }\n} catch (e) {\n    console.error(\&quot;   [Cleanup Error] Could not complete cleanup:\&quot;, e.message);\n} finally {\n    await driver.quit();\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e65d162d-8e8a-4eb6-9176-9dd1f4588641&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Step 1: Login as Admin&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 1: Login as Admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1621,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await driver.get(APP_URL);\nconst emailInput = await driver.wait(until.elementLocated(By.css(&#x27;input[type=\&quot;email\&quot;]&#x27;)), 10000);\nconst passInput = await driver.findElement(By.css(&#x27;input[type=\&quot;password\&quot;]&#x27;));\nawait emailInput.sendKeys(ADMIN_EMAIL);\nawait passInput.sendKeys(ADMIN_PASS);\nconst loginBtn = await driver.findElement(By.className(&#x27;login-button&#x27;));\nawait loginBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Vehicles&#x27;]\&quot;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3386693-e3e7-482e-ae74-854ed4639d5a&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 2: Navigate to Vehicle List&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 2: Navigate to Vehicle List&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:64,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const viewVehiclesBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;View Vehicles&#x27;]\&quot;));\nawait viewVehiclesBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c790e5c7-f74a-416c-b8be-a4631483457d&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 1. Lower Boundaries (Valid) -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 1. Lower Boundaries (Valid) -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3536,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9677f94a-9f60-444b-b9ac-6cab54611c49&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 2. Upper Boundaries (Valid) -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 2. Upper Boundaries (Valid) -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1804,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19667583-47af-468a-9d8e-5c6efd42b577&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 3. Invalid Year (1989) -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 3. Invalid Year (1989) -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3669,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Expected error message not found.&quot;,&quot;estack&quot;:&quot;Error: Expected error message not found.\n    at Context.&lt;anonymous&gt; (automation\\admin_vehicle_tests.js:164:31)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;4f368269-8814-4f77-b5db-b24a61e2b745&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 4. Invalid HP (39) -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 4. Invalid HP (39) -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3712,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Expected error message not found.&quot;,&quot;estack&quot;:&quot;Error: Expected error message not found.\n    at Context.&lt;anonymous&gt; (automation\\admin_vehicle_tests.js:164:31)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;f05df662-7941-4710-a43f-9a7e6ccaa71c&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 5. Missing Field (Color) -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 5. Missing Field (Color) -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2613,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87d0fcbd-d77e-403e-82d8-d38837bab1c5&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 6. Capitalized Color (Valid + Filter Check) -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-03: Admin Add Vehicle &amp; Filtering Validation Step 3: 6. Capitalized Color (Valid + Filter Check) -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1526,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Navigate to Add Page (Handle potential redirect loops)\nconst addVehicleBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Add Vehicle&#x27;]\&quot;)), 10000);\nawait driver.sleep(200);\nawait addVehicleBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Add vehicle&#x27;]\&quot;)), 5000);\n// Fill Form\nif (tc.data.name) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Name\&quot;]&#x27;)).sendKeys(tc.data.name);\nif (tc.data.color) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Color\&quot;]&#x27;)).sendKeys(tc.data.color);\nif (tc.data.year) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Vehicle Year\&quot;]&#x27;)).sendKeys(tc.data.year);\nif (tc.data.engine) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;Engine\&quot;]&#x27;)).sendKeys(tc.data.engine);\nif (tc.data.hp) await driver.findElement(By.css(&#x27;input[placeholder=\&quot;HP\&quot;]&#x27;)).sendKeys(tc.data.hp);\n// Submit\nconst submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Add vehicle&#x27;]\&quot;));\nawait submitBtn.click();\n// Logic\nif (tc.expected === &#x27;success&#x27;) {\n    // Success: Expect table\n    try {\n        await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);\n        const tableText = await driver.findElement(By.className(&#x27;vehicle-table&#x27;)).getText();\n        expect(tableText).to.include(tc.data.name);\n    } catch (err) {\n        const pageSource = await driver.getPageSource();\n        if (pageSource.includes(\&quot;Add vehicle\&quot;)) throw new Error(`Expected SUCCESS but remained on form.`);\n        throw err;\n    }\n} else {\n    // Error: Expect NO table (stay on Add page)\n    await driver.sleep(1000);\n    const tables = await driver.findElements(By.className(&#x27;vehicle-table&#x27;));\n    \n    if (tables.length &gt; 0) {\n        throw new Error(`Bug Found: System accepted invalid data (${tc.desc}). Vehicle was created.`);\n    } else {\n        // Stayed on Add Page (Correct)\n        try {\n            const errorMsgEl = await driver.wait(until.elementLocated(By.className(&#x27;error-message&#x27;)), 2000);\n            expect(await errorMsgEl.getText()).to.not.be.empty;\n            \n            // Reset for next loop\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 5000);\n        } catch (e) {\n            throw new Error(`Expected error message not found.`);\n        }\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;209e46ef-9745-4fc0-8d26-9082abe32527&quot;,&quot;parentUUID&quot;:&quot;3107b503-369a-4f1e-a0cf-c1f8e9bcb094&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d3386693-e3e7-482e-ae74-854ed4639d5a&quot;,&quot;c790e5c7-f74a-416c-b8be-a4631483457d&quot;,&quot;9677f94a-9f60-444b-b9ac-6cab54611c49&quot;,&quot;19667583-47af-468a-9d8e-5c6efd42b577&quot;,&quot;87d0fcbd-d77e-403e-82d8-d38837bab1c5&quot;,&quot;209e46ef-9745-4fc0-8d26-9082abe32527&quot;],&quot;failures&quot;:[&quot;4f368269-8814-4f77-b5db-b24a61e2b745&quot;,&quot;f05df662-7941-4710-a43f-9a7e6ccaa71c&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:18545,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:60000},{&quot;uuid&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;title&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload&quot;,&quot;fullFile&quot;:&quot;C:\\aaFERI\\PREDMETI\\3. Semestar\\VUI\\App\\RIRSsolo\\automation\\company_vehicle_tests.js&quot;,&quot;file&quot;:&quot;\\automation\\company_vehicle_tests.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;TC-02: Company Vehicle Management - Driver License Upload\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload \&quot;before all\&quot; hook in \&quot;TC-02: Company Vehicle Management - Driver License Upload\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:544,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let options = new chrome.Options();\noptions.addArguments(&#x27;--remote-allow-origins=*&#x27;); \noptions.addArguments(&#x27;--disable-search-engine-choice-screen&#x27;); \noptions.addArguments(&#x27;--start-maximized&#x27;);\ndriver = await new Builder()\n    .forBrowser(&#x27;chrome&#x27;)\n    .setChromeOptions(options)\n    .build();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5245b33d-8612-4e0c-b2d9-7491d3b1fcb5&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;TC-02: Company Vehicle Management - Driver License Upload\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload \&quot;after all\&quot; hook in \&quot;TC-02: Company Vehicle Management - Driver License Upload\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (driver) await driver.quit();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c02a1fc-ea0a-47bf-8fd6-25736606064a&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Step 1: Login as Driver&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 1: Login as Driver&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1594,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await driver.get(APP_URL);\n\nconst emailInput = await driver.wait(until.elementLocated(By.css(&#x27;input[type=\&quot;email\&quot;]&#x27;)), 10000);\nconst passInput = await driver.findElement(By.css(&#x27;input[type=\&quot;password\&quot;]&#x27;));\n\nawait emailInput.sendKeys(DRIVER_EMAIL);\nawait passInput.sendKeys(DRIVER_PASS);\n\nconst loginBtn = await driver.findElement(By.className(&#x27;login-button&#x27;));\nawait loginBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;567c8307-7385-48b7-9f9c-234ff237ef60&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 2: Navigate to Profile&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 2: Navigate to Profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:58,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const profileBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;));\nawait profileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d362414c-d9e7-44df-8379-934335a714e0&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: Upload 1mb.docx -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 3: Upload 1mb.docx -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3558,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filePath = path.join(ASSETS_DIR, tc.file);\n\nif (!fs.existsSync(filePath)) throw new Error(`Asset missing: ${filePath}`);\n// 1. Locate and Upload\nconst fileInput = await driver.findElement(By.css(&#x27;input[type=\&quot;file\&quot;]&#x27;));\nawait fileInput.sendKeys(filePath);\nconst uploadBtn = await driver.findElement(By.className(&#x27;upload-button&#x27;));\nawait uploadBtn.click();\n// 2. Wait for message\nconst messageEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 15000);\nawait driver.sleep(1000); // Allow text to update\nconst messageText = await messageEl.getText();\n// 3. Assertions\nif (tc.expected === &#x27;success&#x27;) {\n    expect(messageText).to.include(&#x27;License uploaded successfully&#x27;);\n} else {\n    expect(messageText).to.not.include(&#x27;License uploaded successfully&#x27;, `Bug Found: App allowed ${tc.file}`);\n}\n// 4. CLEANUP: Reset UI State (Do NOT Refresh)\n// Click \&quot;Back to Dashboard\&quot;\nconst backBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Back to Dashboard&#x27;]\&quot;));\nawait backBtn.click();\n// Wait for Dashboard\nconst viewProfileBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 5000);\n\n// Go back to Profile for next test\nawait viewProfileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 5000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1412698-b27b-4db6-a6e0-bf8c2f36cb77&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: Upload 5mb.png -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 3: Upload 5mb.png -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4609,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filePath = path.join(ASSETS_DIR, tc.file);\n\nif (!fs.existsSync(filePath)) throw new Error(`Asset missing: ${filePath}`);\n// 1. Locate and Upload\nconst fileInput = await driver.findElement(By.css(&#x27;input[type=\&quot;file\&quot;]&#x27;));\nawait fileInput.sendKeys(filePath);\nconst uploadBtn = await driver.findElement(By.className(&#x27;upload-button&#x27;));\nawait uploadBtn.click();\n// 2. Wait for message\nconst messageEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 15000);\nawait driver.sleep(1000); // Allow text to update\nconst messageText = await messageEl.getText();\n// 3. Assertions\nif (tc.expected === &#x27;success&#x27;) {\n    expect(messageText).to.include(&#x27;License uploaded successfully&#x27;);\n} else {\n    expect(messageText).to.not.include(&#x27;License uploaded successfully&#x27;, `Bug Found: App allowed ${tc.file}`);\n}\n// 4. CLEANUP: Reset UI State (Do NOT Refresh)\n// Click \&quot;Back to Dashboard\&quot;\nconst backBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Back to Dashboard&#x27;]\&quot;));\nawait backBtn.click();\n// Wait for Dashboard\nconst viewProfileBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 5000);\n\n// Go back to Profile for next test\nawait viewProfileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 5000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67c7a36e-5e1e-4d11-990d-fa9d3f3653b6&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: Upload 6mb.png -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 3: Upload 6mb.png -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6958,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filePath = path.join(ASSETS_DIR, tc.file);\n\nif (!fs.existsSync(filePath)) throw new Error(`Asset missing: ${filePath}`);\n// 1. Locate and Upload\nconst fileInput = await driver.findElement(By.css(&#x27;input[type=\&quot;file\&quot;]&#x27;));\nawait fileInput.sendKeys(filePath);\nconst uploadBtn = await driver.findElement(By.className(&#x27;upload-button&#x27;));\nawait uploadBtn.click();\n// 2. Wait for message\nconst messageEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 15000);\nawait driver.sleep(1000); // Allow text to update\nconst messageText = await messageEl.getText();\n// 3. Assertions\nif (tc.expected === &#x27;success&#x27;) {\n    expect(messageText).to.include(&#x27;License uploaded successfully&#x27;);\n} else {\n    expect(messageText).to.not.include(&#x27;License uploaded successfully&#x27;, `Bug Found: App allowed ${tc.file}`);\n}\n// 4. CLEANUP: Reset UI State (Do NOT Refresh)\n// Click \&quot;Back to Dashboard\&quot;\nconst backBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Back to Dashboard&#x27;]\&quot;));\nawait backBtn.click();\n// Wait for Dashboard\nconst viewProfileBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 5000);\n\n// Go back to Profile for next test\nawait viewProfileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 5000);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: Bug Found: App allowed 6mb.png: expected &#x27;License uploaded successfully&#x27; to not include &#x27;License uploaded successfully&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: Bug Found: App allowed 6mb.png: expected &#x27;License uploaded successfully&#x27; to not include &#x27;License uploaded successfully&#x27;\n    at Context.&lt;anonymous&gt; (automation\\company_vehicle_tests.js:109:44)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;7d299751-e135-4fb5-9b4f-125ed0efb425&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: Upload jpg1kb.jpeg -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 3: Upload jpg1kb.jpeg -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1139,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filePath = path.join(ASSETS_DIR, tc.file);\n\nif (!fs.existsSync(filePath)) throw new Error(`Asset missing: ${filePath}`);\n// 1. Locate and Upload\nconst fileInput = await driver.findElement(By.css(&#x27;input[type=\&quot;file\&quot;]&#x27;));\nawait fileInput.sendKeys(filePath);\nconst uploadBtn = await driver.findElement(By.className(&#x27;upload-button&#x27;));\nawait uploadBtn.click();\n// 2. Wait for message\nconst messageEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 15000);\nawait driver.sleep(1000); // Allow text to update\nconst messageText = await messageEl.getText();\n// 3. Assertions\nif (tc.expected === &#x27;success&#x27;) {\n    expect(messageText).to.include(&#x27;License uploaded successfully&#x27;);\n} else {\n    expect(messageText).to.not.include(&#x27;License uploaded successfully&#x27;, `Bug Found: App allowed ${tc.file}`);\n}\n// 4. CLEANUP: Reset UI State (Do NOT Refresh)\n// Click \&quot;Back to Dashboard\&quot;\nconst backBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Back to Dashboard&#x27;]\&quot;));\nawait backBtn.click();\n// Wait for Dashboard\nconst viewProfileBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 5000);\n\n// Go back to Profile for next test\nawait viewProfileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 5000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba24f1bb-34eb-4503-92d6-350938e01c2e&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: Upload png300kb.png -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-02: Company Vehicle Management - Driver License Upload Step 3: Upload png300kb.png -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2450,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filePath = path.join(ASSETS_DIR, tc.file);\n\nif (!fs.existsSync(filePath)) throw new Error(`Asset missing: ${filePath}`);\n// 1. Locate and Upload\nconst fileInput = await driver.findElement(By.css(&#x27;input[type=\&quot;file\&quot;]&#x27;));\nawait fileInput.sendKeys(filePath);\nconst uploadBtn = await driver.findElement(By.className(&#x27;upload-button&#x27;));\nawait uploadBtn.click();\n// 2. Wait for message\nconst messageEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 15000);\nawait driver.sleep(1000); // Allow text to update\nconst messageText = await messageEl.getText();\n// 3. Assertions\nif (tc.expected === &#x27;success&#x27;) {\n    expect(messageText).to.include(&#x27;License uploaded successfully&#x27;);\n} else {\n    expect(messageText).to.not.include(&#x27;License uploaded successfully&#x27;, `Bug Found: App allowed ${tc.file}`);\n}\n// 4. CLEANUP: Reset UI State (Do NOT Refresh)\n// Click \&quot;Back to Dashboard\&quot;\nconst backBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Back to Dashboard&#x27;]\&quot;));\nawait backBtn.click();\n// Wait for Dashboard\nconst viewProfileBtn = await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;View Profile&#x27;]\&quot;)), 5000);\n\n// Go back to Profile for next test\nawait viewProfileBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h3[contains(text(), &#x27;Update Driver’s License&#x27;)]\&quot;)), 5000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b5268ac-6fb3-47fb-b5a2-d1a74d3d5771&quot;,&quot;parentUUID&quot;:&quot;8d7f85fb-a107-4d24-a93d-7c7ca3662945&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;567c8307-7385-48b7-9f9c-234ff237ef60&quot;,&quot;d362414c-d9e7-44df-8379-934335a714e0&quot;,&quot;f1412698-b27b-4db6-a6e0-bf8c2f36cb77&quot;,&quot;67c7a36e-5e1e-4d11-990d-fa9d3f3653b6&quot;,&quot;ba24f1bb-34eb-4503-92d6-350938e01c2e&quot;,&quot;6b5268ac-6fb3-47fb-b5a2-d1a74d3d5771&quot;],&quot;failures&quot;:[&quot;7d299751-e135-4fb5-9b4f-125ed0efb425&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:20366,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:60000},{&quot;uuid&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;title&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules&quot;,&quot;fullFile&quot;:&quot;C:\\aaFERI\\PREDMETI\\3. Semestar\\VUI\\App\\RIRSsolo\\automation\\driver_reservation_tests.js&quot;,&quot;file&quot;:&quot;\\automation\\driver_reservation_tests.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules \&quot;before all\&quot; hook in \&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:604,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let options = new chrome.Options();\noptions.addArguments(&#x27;--remote-allow-origins=*&#x27;);\noptions.addArguments(&#x27;--disable-search-engine-choice-screen&#x27;);\noptions.addArguments(&#x27;--start-maximized&#x27;);\ndriver = await new Builder().forBrowser(&#x27;chrome&#x27;).setChromeOptions(options).build();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91719bf0-b2ea-49d2-8f82-1c56a4ecd1fa&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules\&quot;&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules \&quot;after all\&quot; hook in \&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1087,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (driver) {\n    // Final Safety Net Cleanup\n    await cleanupReservation(driver);\n    await driver.quit();\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5afe03b0-8b40-43dc-ad0c-e58c9b4af01b&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Step 1: Login as Driver&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 1: Login as Driver&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1575,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await driver.get(APP_URL);\nconst emailInput = await driver.wait(until.elementLocated(By.css(&#x27;input[type=\&quot;email\&quot;]&#x27;)), 10000);\nawait emailInput.sendKeys(DRIVER_EMAIL);\nawait driver.findElement(By.css(&#x27;input[type=\&quot;password\&quot;]&#x27;)).sendKeys(DRIVER_PASS);\nawait driver.findElement(By.className(&#x27;login-button&#x27;)).click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Reserve Vehicle&#x27;]\&quot;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b4d6b8c0-0c0c-4f7b-a492-134e658fd356&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 2: Navigate to Vehicle List&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 2: Navigate to Vehicle List&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1135,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const reserveBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Reserve Vehicle&#x27;]\&quot;));\nawait reserveBtn.click();\nawait driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 10000);\nawait driver.wait(until.elementLocated(By.className(&#x27;vehicle-table&#x27;)), 10000);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e78e8d6-1330-46e1-bb20-67bc35454ff6&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 1. Valid: Start Today, End Tomorrow -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 3: 1. Valid: Start Today, End Tomorrow -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// TRY-FINALLY BLOCK TO GUARANTEE CLEANUP\ntry {\n    // 1. Initial Cleanup (ensure previous test didn&#x27;t leave a mess)\n    await cleanupReservation(driver);\n    // 2. Find an Available Vehicle\n    const reserveBtns = await driver.findElements(By.className(&#x27;reserve-button&#x27;));\n    if (reserveBtns.length === 0) {\n        throw new Error(\&quot;No available vehicles to reserve! Previous cleanup might have failed.\&quot;);\n    }\n    // Click the first one\n    const firstReserveBtn = reserveBtns[0];\n    await driver.executeScript(\&quot;arguments[0].scrollIntoView(true);\&quot;, firstReserveBtn);\n    await firstReserveBtn.click();\n    // 3. Wait for Reservation Form\n    await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Reserve Vehicle&#x27;]\&quot;)), 5000);\n    // 4. Set Date\n    const targetDate = getDate(tc.daysOffset);\n    await selectDateOnCalendar(driver, targetDate);\n    // 5. Submit\n    const submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Reserve&#x27;]\&quot;));\n    await submitBtn.click();\n    // 6. Verification\n    if (tc.expected === &#x27;success&#x27;) {\n        try {\n            // Expect redirect back to list\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n            // Verify \&quot;Remove Reserve\&quot; button appears\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Remove Reserve&#x27;]\&quot;)), 5000);\n        } catch (err) {\n            // Check if stuck on form\n            const pageSource = await driver.getPageSource();\n            if (pageSource.includes(\&quot;Reserve Vehicle\&quot;)) {\n                 let msg = \&quot;Unknown\&quot;;\n                 try { msg = await driver.findElement(By.className(&#x27;profile-message&#x27;)).getText(); } catch(e){}\n                 throw new Error(`Expected SUCCESS but stayed on form. Msg: ${msg}`);\n            }\n            throw err;\n        }\n    } else {\n        // EXPECTED ERROR\n        await driver.sleep(1000);\n        const headers = await driver.findElements(By.tagName(&#x27;h2&#x27;));\n        let headerText = headers.length &gt; 0 ? await headers[0].getText() : \&quot;\&quot;;\n        if (headerText.includes(&#x27;List of All Vehicles&#x27;)) {\n            // BUG FOUND: It redirected (Success) when it should have failed.\n            throw new Error(`Bug Found: App allowed invalid reservation duration (${tc.daysOffset} days).`);\n        } else {\n            // Correct: Stayed on page, show error\n            const msgEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 2000);\n            expect(await msgEl.getText()).to.not.be.empty;\n            \n            // Manual Reset back to list so next test can run\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n        }\n    }\n} finally {\n    // --- THIS RUNS EVERY TIME, EVEN IF BUG FOUND ---\n    // If we ended up with a reservation (validly OR via bug), remove it now.\n    if (tc.expected === &#x27;success&#x27;) {\n        await cleanupReservation(driver);\n    } else {\n        // If it was an error test case, check if it accidentally created a reservation anyway\n        // We pause briefly to let any redirects finish\n        await driver.sleep(500);\n        await cleanupReservation(driver);\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50a8dc36-c0ff-408b-81b8-37bc2eb13ab2&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 2. Valid: Start Today, End +30 days -&gt; Expect: success&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 3: 2. Valid: Start Today, End +30 days -&gt; Expect: success&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4242,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// TRY-FINALLY BLOCK TO GUARANTEE CLEANUP\ntry {\n    // 1. Initial Cleanup (ensure previous test didn&#x27;t leave a mess)\n    await cleanupReservation(driver);\n    // 2. Find an Available Vehicle\n    const reserveBtns = await driver.findElements(By.className(&#x27;reserve-button&#x27;));\n    if (reserveBtns.length === 0) {\n        throw new Error(\&quot;No available vehicles to reserve! Previous cleanup might have failed.\&quot;);\n    }\n    // Click the first one\n    const firstReserveBtn = reserveBtns[0];\n    await driver.executeScript(\&quot;arguments[0].scrollIntoView(true);\&quot;, firstReserveBtn);\n    await firstReserveBtn.click();\n    // 3. Wait for Reservation Form\n    await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Reserve Vehicle&#x27;]\&quot;)), 5000);\n    // 4. Set Date\n    const targetDate = getDate(tc.daysOffset);\n    await selectDateOnCalendar(driver, targetDate);\n    // 5. Submit\n    const submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Reserve&#x27;]\&quot;));\n    await submitBtn.click();\n    // 6. Verification\n    if (tc.expected === &#x27;success&#x27;) {\n        try {\n            // Expect redirect back to list\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n            // Verify \&quot;Remove Reserve\&quot; button appears\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Remove Reserve&#x27;]\&quot;)), 5000);\n        } catch (err) {\n            // Check if stuck on form\n            const pageSource = await driver.getPageSource();\n            if (pageSource.includes(\&quot;Reserve Vehicle\&quot;)) {\n                 let msg = \&quot;Unknown\&quot;;\n                 try { msg = await driver.findElement(By.className(&#x27;profile-message&#x27;)).getText(); } catch(e){}\n                 throw new Error(`Expected SUCCESS but stayed on form. Msg: ${msg}`);\n            }\n            throw err;\n        }\n    } else {\n        // EXPECTED ERROR\n        await driver.sleep(1000);\n        const headers = await driver.findElements(By.tagName(&#x27;h2&#x27;));\n        let headerText = headers.length &gt; 0 ? await headers[0].getText() : \&quot;\&quot;;\n        if (headerText.includes(&#x27;List of All Vehicles&#x27;)) {\n            // BUG FOUND: It redirected (Success) when it should have failed.\n            throw new Error(`Bug Found: App allowed invalid reservation duration (${tc.daysOffset} days).`);\n        } else {\n            // Correct: Stayed on page, show error\n            const msgEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 2000);\n            expect(await msgEl.getText()).to.not.be.empty;\n            \n            // Manual Reset back to list so next test can run\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n        }\n    }\n} finally {\n    // --- THIS RUNS EVERY TIME, EVEN IF BUG FOUND ---\n    // If we ended up with a reservation (validly OR via bug), remove it now.\n    if (tc.expected === &#x27;success&#x27;) {\n        await cleanupReservation(driver);\n    } else {\n        // If it was an error test case, check if it accidentally created a reservation anyway\n        // We pause briefly to let any redirects finish\n        await driver.sleep(500);\n        await cleanupReservation(driver);\n    }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d1e1f9c-a025-4756-a52a-e387e5eb8e2e&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 3. Invalid: Start Today, End Today (0 days) -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 3: 3. Invalid: Start Today, End Today (0 days) -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4632,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// TRY-FINALLY BLOCK TO GUARANTEE CLEANUP\ntry {\n    // 1. Initial Cleanup (ensure previous test didn&#x27;t leave a mess)\n    await cleanupReservation(driver);\n    // 2. Find an Available Vehicle\n    const reserveBtns = await driver.findElements(By.className(&#x27;reserve-button&#x27;));\n    if (reserveBtns.length === 0) {\n        throw new Error(\&quot;No available vehicles to reserve! Previous cleanup might have failed.\&quot;);\n    }\n    // Click the first one\n    const firstReserveBtn = reserveBtns[0];\n    await driver.executeScript(\&quot;arguments[0].scrollIntoView(true);\&quot;, firstReserveBtn);\n    await firstReserveBtn.click();\n    // 3. Wait for Reservation Form\n    await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Reserve Vehicle&#x27;]\&quot;)), 5000);\n    // 4. Set Date\n    const targetDate = getDate(tc.daysOffset);\n    await selectDateOnCalendar(driver, targetDate);\n    // 5. Submit\n    const submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Reserve&#x27;]\&quot;));\n    await submitBtn.click();\n    // 6. Verification\n    if (tc.expected === &#x27;success&#x27;) {\n        try {\n            // Expect redirect back to list\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n            // Verify \&quot;Remove Reserve\&quot; button appears\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Remove Reserve&#x27;]\&quot;)), 5000);\n        } catch (err) {\n            // Check if stuck on form\n            const pageSource = await driver.getPageSource();\n            if (pageSource.includes(\&quot;Reserve Vehicle\&quot;)) {\n                 let msg = \&quot;Unknown\&quot;;\n                 try { msg = await driver.findElement(By.className(&#x27;profile-message&#x27;)).getText(); } catch(e){}\n                 throw new Error(`Expected SUCCESS but stayed on form. Msg: ${msg}`);\n            }\n            throw err;\n        }\n    } else {\n        // EXPECTED ERROR\n        await driver.sleep(1000);\n        const headers = await driver.findElements(By.tagName(&#x27;h2&#x27;));\n        let headerText = headers.length &gt; 0 ? await headers[0].getText() : \&quot;\&quot;;\n        if (headerText.includes(&#x27;List of All Vehicles&#x27;)) {\n            // BUG FOUND: It redirected (Success) when it should have failed.\n            throw new Error(`Bug Found: App allowed invalid reservation duration (${tc.daysOffset} days).`);\n        } else {\n            // Correct: Stayed on page, show error\n            const msgEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 2000);\n            expect(await msgEl.getText()).to.not.be.empty;\n            \n            // Manual Reset back to list so next test can run\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n        }\n    }\n} finally {\n    // --- THIS RUNS EVERY TIME, EVEN IF BUG FOUND ---\n    // If we ended up with a reservation (validly OR via bug), remove it now.\n    if (tc.expected === &#x27;success&#x27;) {\n        await cleanupReservation(driver);\n    } else {\n        // If it was an error test case, check if it accidentally created a reservation anyway\n        // We pause briefly to let any redirects finish\n        await driver.sleep(500);\n        await cleanupReservation(driver);\n    }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Bug Found: App allowed invalid reservation duration (0 days).&quot;,&quot;estack&quot;:&quot;Error: Bug Found: App allowed invalid reservation duration (0 days).\n    at Context.&lt;anonymous&gt; (automation\\driver_reservation_tests.js:166:31)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;06e1fc5b-bb0a-4245-b9b8-65be2bed8813&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Step 3: 4. Invalid: Start Today, End +31 days -&gt; Expect: error&quot;,&quot;fullTitle&quot;:&quot;TC-04: Driver Vehicle Reservation &amp; Date Rules Step 3: 4. Invalid: Start Today, End +31 days -&gt; Expect: error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4601,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// TRY-FINALLY BLOCK TO GUARANTEE CLEANUP\ntry {\n    // 1. Initial Cleanup (ensure previous test didn&#x27;t leave a mess)\n    await cleanupReservation(driver);\n    // 2. Find an Available Vehicle\n    const reserveBtns = await driver.findElements(By.className(&#x27;reserve-button&#x27;));\n    if (reserveBtns.length === 0) {\n        throw new Error(\&quot;No available vehicles to reserve! Previous cleanup might have failed.\&quot;);\n    }\n    // Click the first one\n    const firstReserveBtn = reserveBtns[0];\n    await driver.executeScript(\&quot;arguments[0].scrollIntoView(true);\&quot;, firstReserveBtn);\n    await firstReserveBtn.click();\n    // 3. Wait for Reservation Form\n    await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;Reserve Vehicle&#x27;]\&quot;)), 5000);\n    // 4. Set Date\n    const targetDate = getDate(tc.daysOffset);\n    await selectDateOnCalendar(driver, targetDate);\n    // 5. Submit\n    const submitBtn = await driver.findElement(By.xpath(\&quot;//button[text()=&#x27;Reserve&#x27;]\&quot;));\n    await submitBtn.click();\n    // 6. Verification\n    if (tc.expected === &#x27;success&#x27;) {\n        try {\n            // Expect redirect back to list\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n            // Verify \&quot;Remove Reserve\&quot; button appears\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//button[text()=&#x27;Remove Reserve&#x27;]\&quot;)), 5000);\n        } catch (err) {\n            // Check if stuck on form\n            const pageSource = await driver.getPageSource();\n            if (pageSource.includes(\&quot;Reserve Vehicle\&quot;)) {\n                 let msg = \&quot;Unknown\&quot;;\n                 try { msg = await driver.findElement(By.className(&#x27;profile-message&#x27;)).getText(); } catch(e){}\n                 throw new Error(`Expected SUCCESS but stayed on form. Msg: ${msg}`);\n            }\n            throw err;\n        }\n    } else {\n        // EXPECTED ERROR\n        await driver.sleep(1000);\n        const headers = await driver.findElements(By.tagName(&#x27;h2&#x27;));\n        let headerText = headers.length &gt; 0 ? await headers[0].getText() : \&quot;\&quot;;\n        if (headerText.includes(&#x27;List of All Vehicles&#x27;)) {\n            // BUG FOUND: It redirected (Success) when it should have failed.\n            throw new Error(`Bug Found: App allowed invalid reservation duration (${tc.daysOffset} days).`);\n        } else {\n            // Correct: Stayed on page, show error\n            const msgEl = await driver.wait(until.elementLocated(By.className(&#x27;profile-message&#x27;)), 2000);\n            expect(await msgEl.getText()).to.not.be.empty;\n            \n            // Manual Reset back to list so next test can run\n            const backBtn = await driver.findElement(By.className(&#x27;goto-vehicle-select-button&#x27;));\n            await backBtn.click();\n            await driver.wait(until.elementLocated(By.xpath(\&quot;//h2[text()=&#x27;List of All Vehicles&#x27;]\&quot;)), 5000);\n        }\n    }\n} finally {\n    // --- THIS RUNS EVERY TIME, EVEN IF BUG FOUND ---\n    // If we ended up with a reservation (validly OR via bug), remove it now.\n    if (tc.expected === &#x27;success&#x27;) {\n        await cleanupReservation(driver);\n    } else {\n        // If it was an error test case, check if it accidentally created a reservation anyway\n        // We pause briefly to let any redirects finish\n        await driver.sleep(500);\n        await cleanupReservation(driver);\n    }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Bug Found: App allowed invalid reservation duration (31 days).&quot;,&quot;estack&quot;:&quot;Error: Bug Found: App allowed invalid reservation duration (31 days).\n    at Context.&lt;anonymous&gt; (automation\\driver_reservation_tests.js:166:31)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;dacc4b04-9873-4343-a11b-578c70f530cd&quot;,&quot;parentUUID&quot;:&quot;6f5d5911-1120-4ba9-97df-53f1c78e8215&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b4d6b8c0-0c0c-4f7b-a492-134e658fd356&quot;,&quot;6e78e8d6-1330-46e1-bb20-67bc35454ff6&quot;,&quot;50a8dc36-c0ff-408b-81b8-37bc2eb13ab2&quot;,&quot;5d1e1f9c-a025-4756-a52a-e387e5eb8e2e&quot;],&quot;failures&quot;:[&quot;06e1fc5b-bb0a-4245-b9b8-65be2bed8813&quot;,&quot;dacc4b04-9873-4343-a11b-578c70f530cd&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:20399,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:60000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;11.7.5&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;full-report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.4&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportFilename&quot;:&quot;full-report&quot;,&quot;overwrite&quot;:&quot;true&quot;},&quot;version&quot;:&quot;6.3.2&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;full-report&quot;,&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportTitle&quot;:&quot;RIRSsolo&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-report\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\aaFERI\\PREDMETI\\3. Semestar\\VUI\\App\\RIRSsolo\\test-report\\full-report.json&quot;,&quot;htmlFile&quot;:&quot;C:\\aaFERI\\PREDMETI\\3. Semestar\\VUI\\App\\RIRSsolo\\test-report\\full-report.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>